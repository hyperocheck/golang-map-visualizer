var et=Object.defineProperty;var tt=(t,e,n)=>e in t?et(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ye=(t,e,n)=>(tt(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const f of o)if(f.type==="childList")for(const s of f.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const f={};return o.integrity&&(f.integrity=o.integrity),o.referrerPolicy&&(f.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?f.credentials="include":o.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function l(o){if(o.ep)return;o.ep=!0;const f=n(o);fetch(o.href,f)}})();function de(){}function Ge(t){return t()}function Oe(){return Object.create(null)}function _e(t){t.forEach(Ge)}function Je(t){return typeof t=="function"}function nt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function lt(t){return Object.keys(t).length===0}function Me(t){return t??""}function L(t,e){t.appendChild(e)}function x(t,e,n){t.insertBefore(e,n||null)}function D(t){t.parentNode&&t.parentNode.removeChild(t)}function he(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function ne(t){return document.createElement(t)}function I(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ee(t){return document.createTextNode(t)}function me(){return ee(" ")}function le(){return ee("")}function fe(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function i(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function it(t){return Array.from(t.childNodes)}function ie(t,e){e=""+e,t.data!==e&&(t.data=e)}function we(t,e,n,l){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,l?"important":"")}let pe;function ge(t){pe=t}function ot(){if(!pe)throw new Error("Function called outside component initialization");return pe}function st(t){ot().$$.on_mount.push(t)}const ae=[],Se=[];let ce=[];const Ee=[],ft=Promise.resolve();let be=!1;function rt(){be||(be=!0,ft.then(Qe))}function Ae(t){ce.push(t)}const ve=new Set;let re=0;function Qe(){if(re!==0)return;const t=pe;do{try{for(;re<ae.length;){const e=ae[re];re++,ge(e),ut(e.$$)}}catch(e){throw ae.length=0,re=0,e}for(ge(null),ae.length=0,re=0;Se.length;)Se.pop()();for(let e=0;e<ce.length;e+=1){const n=ce[e];ve.has(n)||(ve.add(n),n())}ce.length=0}while(ae.length);for(;Ee.length;)Ee.pop()();be=!1,ve.clear(),ge(t)}function ut(t){if(t.fragment!==null){t.update(),_e(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ae)}}function at(t){const e=[],n=[];ce.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),ce=e}const ht=new Set;function $e(t,e){t&&t.i&&(ht.delete(t),t.i(e))}function K(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ct(t,e){t.d(1),e.delete(t.key)}function dt(t,e,n,l,o,f,s,u,h,a,m,c){let y=t.length,r=f.length,O=y;const C={};for(;O--;)C[t[O].key]=O;const W=[],P=new Map,N=new Map,U=[];for(O=r;O--;){const A=c(o,f,O),E=n(A);let R=s.get(E);R?l&&U.push(()=>R.p(A,e)):(R=a(E,A),R.c()),P.set(E,W[O]=R),E in C&&N.set(E,Math.abs(O-C[E]))}const G=new Set,J=new Set;function d(A){$e(A,1),A.m(u,m),s.set(A.key,A),m=A.first,r--}for(;y&&r;){const A=W[r-1],E=t[y-1],R=A.key,Z=E.key;A===E?(m=A.first,y--,r--):P.has(Z)?!s.has(R)||G.has(R)?d(A):J.has(Z)?y--:N.get(R)>N.get(Z)?(J.add(R),d(A)):(G.add(Z),y--):(h(E,s),y--)}for(;y--;){const A=t[y];P.has(A.key)||h(A,s)}for(;r;)d(W[r-1]);return _e(U),W}function _t(t,e,n){const{fragment:l,after_update:o}=t.$$;l&&l.m(e,n),Ae(()=>{const f=t.$$.on_mount.map(Ge).filter(Je);t.$$.on_destroy?t.$$.on_destroy.push(...f):_e(f),t.$$.on_mount=[]}),o.forEach(Ae)}function gt(t,e){const n=t.$$;n.fragment!==null&&(at(n.after_update),_e(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function pt(t,e){t.$$.dirty[0]===-1&&(ae.push(t),rt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function mt(t,e,n,l,o,f,s=null,u=[-1]){const h=pe;ge(t);const a=t.$$={fragment:null,ctx:[],props:f,update:de,not_equal:o,bound:Oe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:Oe(),dirty:u,skip_bound:!1,root:e.target||h.$$.root};s&&s(a.root);let m=!1;if(a.ctx=n?n(t,e.props||{},(c,y,...r)=>{const O=r.length?r[0]:y;return a.ctx&&o(a.ctx[c],a.ctx[c]=O)&&(!a.skip_bound&&a.bound[c]&&a.bound[c](O),m&&pt(t,c)),y}):[],a.update(),m=!0,_e(a.before_update),a.fragment=l?l(a.ctx):!1,e.target){if(e.hydrate){const c=it(e.target);a.fragment&&a.fragment.l(c),c.forEach(D)}else a.fragment&&a.fragment.c();e.intro&&$e(t.$$.fragment),_t(t,e.target,e.anchor),Qe()}ge(h)}class wt{constructor(){ye(this,"$$");ye(this,"$$set")}$destroy(){gt(this,1),this.$destroy=de}$on(e,n){if(!Je(n))return de;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!lt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const yt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(yt);function Le(t,e,n){const l=t.slice();return l[27]=e[n][0],l[28]=e[n][1],l}function Be(t,e,n){const l=t.slice();return l[31]=e[n],l}function We(t,e,n){const l=t.slice();return l[34]=e[n],l}function ke(t){const e=t.slice(),n=(e[34].bucket.keys||[]).length;e[37]=n;const l=(e[34].bucket.values||[]).length;return e[38]=l,e}function Ce(t,e,n){var f;const l=t.slice();l[28]=e[n],l[40]=n;const o=(((f=l[34].bucket)==null?void 0:f.keys)||[]).length;return l[37]=o,l}function Pe(t,e,n){const l=t.slice();return l[27]=e[n],l[40]=n,l}function Ne(t,e,n){const l=t.slice();return l[42]=e[n],l[40]=n,l}function Ye(t,e,n){const l=t.slice();return l[44]=e[n],l}function ze(t){let e,n=t[44].text+"",l,o,f,s;return{c(){e=I("text"),l=ee(n),i(e,"x",o=t[44].x),i(e,"y",f=t[44].y),i(e,"class",s=Me(t[44].isOld?"label-old":"label-new")+" svelte-x4wxi1"),i(e,"font-size","14"),i(e,"font-weight","bold"),i(e,"font-family","Arial, sans-serif")},m(u,h){x(u,e,h),L(e,l)},p(u,h){h[0]&8&&n!==(n=u[44].text+"")&&ie(l,n),h[0]&8&&o!==(o=u[44].x)&&i(e,"x",o),h[0]&8&&f!==(f=u[44].y)&&i(e,"y",f),h[0]&8&&s!==(s=Me(u[44].isOld?"label-old":"label-new")+" svelte-x4wxi1")&&i(e,"class",s)},d(u){u&&D(e)}}}function Xe(t){var U,G,J;let e,n,l,o,f,s,u,h,a,m,c,y=K(((U=t[34].bucket)==null?void 0:U.tophash)||[]),r=[];for(let d=0;d<y.length;d+=1)r[d]=je(Ne(t,y,d));let O=K(((G=t[34].bucket)==null?void 0:G.keys)||[]),C=[];for(let d=0;d<O.length;d+=1)C[d]=Ie(Pe(t,O,d));let W=K(((J=t[34].bucket)==null?void 0:J.values)||[]),P=[];for(let d=0;d<W.length;d+=1)P[d]=Re(Ce(t,W,d));let N=t[34].bucket&&Te(ke(t));return{c(){e=I("g"),n=I("rect");for(let d=0;d<r.length;d+=1)r[d].c();h=le();for(let d=0;d<C.length;d+=1)C[d].c();a=le();for(let d=0;d<P.length;d+=1)P[d].c();m=le(),N&&N.c(),i(n,"class",l="bucket-rect "+(t[34].isOld?"bucket-old":"")+" svelte-x4wxi1"),i(n,"width",o=t[34].width),i(n,"height",f=t[34].height),i(n,"fill","#fff"),i(n,"stroke",s=t[34].isOld?"#ff6b6b":"#000"),i(n,"stroke-width",u=t[34].isOld?2:qe),i(n,"rx",Ze),i(n,"ry",Ze),i(n,"filter","url(#bucket-shadow)"),i(e,"transform",c=`translate(${t[34].x}, ${t[34].y})`),i(e,"class","bucket-group svelte-x4wxi1")},m(d,A){x(d,e,A),L(e,n);for(let E=0;E<r.length;E+=1)r[E]&&r[E].m(e,null);L(e,h);for(let E=0;E<C.length;E+=1)C[E]&&C[E].m(e,null);L(e,a);for(let E=0;E<P.length;E+=1)P[E]&&P[E].m(e,null);L(e,m),N&&N.m(e,null)},p(d,A){var E,R,Z;if(A[0]&2&&l!==(l="bucket-rect "+(d[34].isOld?"bucket-old":"")+" svelte-x4wxi1")&&i(n,"class",l),A[0]&2&&o!==(o=d[34].width)&&i(n,"width",o),A[0]&2&&f!==(f=d[34].height)&&i(n,"height",f),A[0]&2&&s!==(s=d[34].isOld?"#ff6b6b":"#000")&&i(n,"stroke",s),A[0]&2&&u!==(u=d[34].isOld?2:qe)&&i(n,"stroke-width",u),A[0]&2){y=K(((E=d[34].bucket)==null?void 0:E.tophash)||[]);let v;for(v=0;v<y.length;v+=1){const p=Ne(d,y,v);r[v]?r[v].p(p,A):(r[v]=je(p),r[v].c(),r[v].m(e,h))}for(;v<r.length;v+=1)r[v].d(1);r.length=y.length}if(A[0]&2){O=K(((R=d[34].bucket)==null?void 0:R.keys)||[]);let v;for(v=0;v<O.length;v+=1){const p=Pe(d,O,v);C[v]?C[v].p(p,A):(C[v]=Ie(p),C[v].c(),C[v].m(e,a))}for(;v<C.length;v+=1)C[v].d(1);C.length=O.length}if(A[0]&2){W=K(((Z=d[34].bucket)==null?void 0:Z.values)||[]);let v;for(v=0;v<W.length;v+=1){const p=Ce(d,W,v);P[v]?P[v].p(p,A):(P[v]=Re(p),P[v].c(),P[v].m(e,m))}for(;v<P.length;v+=1)P[v].d(1);P.length=W.length}d[34].bucket?N?N.p(ke(d),A):(N=Te(ke(d)),N.c(),N.m(e,null)):N&&(N.d(1),N=null),A[0]&2&&c!==(c=`translate(${d[34].x}, ${d[34].y})`)&&i(e,"transform",c)},d(d){d&&D(e),he(r,d),he(C,d),he(P,d),N&&N.d()}}}function je(t){let e,n,l,o,f=t[42]+"",s,u,h;return{c(){e=I("rect"),o=I("text"),s=ee(f),i(e,"x",n=t[34].padding+t[40]*te),i(e,"y",l=t[34].padding),i(e,"width",te),i(e,"height",H),i(e,"fill","#eee"),i(e,"stroke","#000"),i(o,"x",u=t[34].padding+t[40]*te+te/2),i(o,"y",h=t[34].padding+H/1.5),i(o,"font-size","12"),i(o,"text-anchor","middle")},m(a,m){x(a,e,m),x(a,o,m),L(o,s)},p(a,m){m[0]&2&&n!==(n=a[34].padding+a[40]*te)&&i(e,"x",n),m[0]&2&&l!==(l=a[34].padding)&&i(e,"y",l),m[0]&2&&f!==(f=a[42]+"")&&ie(s,f),m[0]&2&&u!==(u=a[34].padding+a[40]*te+te/2)&&i(o,"x",u),m[0]&2&&h!==(h=a[34].padding+H/1.5)&&i(o,"y",h)},d(a){a&&(D(e),D(o))}}}function Ie(t){let e,n,l,o,f,s,u=(t[27]??"")+"",h,a,m;return{c(){e=I("rect"),s=I("text"),h=ee(u),i(e,"x",n=t[34].padding),i(e,"y",l=t[34].padding+H+t[40]*M),i(e,"width",o=t[34].width-q*2),i(e,"height",M),i(e,"fill",f=t[27]==null?"#dbfdc9":"#b2f2bb"),i(e,"stroke","#12b886"),i(e,"class","cell-key svelte-x4wxi1"),i(s,"x",a=t[34].padding+6),i(s,"y",m=t[34].padding+H+t[40]*M+M/1.5),i(s,"font-size","13")},m(c,y){x(c,e,y),x(c,s,y),L(s,h)},p(c,y){y[0]&2&&n!==(n=c[34].padding)&&i(e,"x",n),y[0]&2&&l!==(l=c[34].padding+H+c[40]*M)&&i(e,"y",l),y[0]&2&&o!==(o=c[34].width-q*2)&&i(e,"width",o),y[0]&2&&f!==(f=c[27]==null?"#dbfdc9":"#b2f2bb")&&i(e,"fill",f),y[0]&2&&u!==(u=(c[27]??"")+"")&&ie(h,u),y[0]&2&&a!==(a=c[34].padding+6)&&i(s,"x",a),y[0]&2&&m!==(m=c[34].padding+H+c[40]*M+M/1.5)&&i(s,"y",m)},d(c){c&&(D(e),D(s))}}}function Re(t){let e,n,l,o,f,s,u=(t[28]??"")+"",h,a,m;return{c(){e=I("rect"),s=I("text"),h=ee(u),i(e,"x",n=t[34].padding),i(e,"y",l=t[34].padding+H+t[37]*M+t[40]*M),i(e,"width",o=t[34].width-q*2),i(e,"height",M),i(e,"fill",f=t[28]==null?"#fff2b8":"#ffec99"),i(e,"stroke","#ffa94d"),i(e,"class","cell-value svelte-x4wxi1"),i(s,"x",a=t[34].padding+6),i(s,"y",m=t[34].padding+H+t[37]*M+t[40]*M+M/1.5),i(s,"font-size","13")},m(c,y){x(c,e,y),x(c,s,y),L(s,h)},p(c,y){y[0]&2&&n!==(n=c[34].padding)&&i(e,"x",n),y[0]&2&&l!==(l=c[34].padding+H+c[37]*M+c[40]*M)&&i(e,"y",l),y[0]&2&&o!==(o=c[34].width-q*2)&&i(e,"width",o),y[0]&2&&f!==(f=c[28]==null?"#fff2b8":"#ffec99")&&i(e,"fill",f),y[0]&2&&u!==(u=(c[28]??"")+"")&&ie(h,u),y[0]&2&&a!==(a=c[34].padding+6)&&i(s,"x",a),y[0]&2&&m!==(m=c[34].padding+H+c[37]*M+c[40]*M+M/1.5)&&i(s,"y",m)},d(c){c&&(D(e),D(s))}}}function Te(t){let e,n,l,o,f,s=(t[34].bucket.overflow||"")+"",u,h,a;return{c(){e=I("rect"),f=I("text"),u=ee(s),i(e,"x",n=t[34].padding),i(e,"y",l=t[34].padding+H+t[37]*M+t[38]*M),i(e,"width",o=t[34].width-q*2),i(e,"height",M),i(e,"fill","#ddd"),i(e,"stroke","#000"),i(f,"x",h=t[34].padding+6),i(f,"y",a=t[34].padding+H+t[37]*M+t[38]*M+M/1.5),i(f,"font-size","12")},m(m,c){x(m,e,c),x(m,f,c),L(f,u)},p(m,c){c[0]&2&&n!==(n=m[34].padding)&&i(e,"x",n),c[0]&2&&l!==(l=m[34].padding+H+m[37]*M+m[38]*M)&&i(e,"y",l),c[0]&2&&o!==(o=m[34].width-q*2)&&i(e,"width",o),c[0]&2&&s!==(s=(m[34].bucket.overflow||"")+"")&&ie(u,s),c[0]&2&&h!==(h=m[34].padding+6)&&i(f,"x",h),c[0]&2&&a!==(a=m[34].padding+H+m[37]*M+m[38]*M+M/1.5)&&i(f,"y",a)},d(m){m&&(D(e),D(f))}}}function De(t,e){let n,l,o=e[34].x+e[34].width>e[4].x&&e[34].x<e[4].x+e[4].w&&e[34].y+e[34].height>e[4].y&&e[34].y<e[4].y+e[4].h&&Xe(e);return{key:t,first:null,c(){n=le(),o&&o.c(),l=le(),this.first=n},m(f,s){x(f,n,s),o&&o.m(f,s),x(f,l,s)},p(f,s){e=f,e[34].x+e[34].width>e[4].x&&e[34].x<e[4].x+e[4].w&&e[34].y+e[34].height>e[4].y&&e[34].y<e[4].y+e[4].h?o?o.p(e,s):(o=Xe(e),o.c(),o.m(l.parentNode,l)):o&&(o.d(1),o=null)},d(f){f&&(D(n),D(l)),o&&o.d(f)}}}function xe(t){let e,n,l,o,f,s,u;return{c(){e=I("line"),i(e,"x1",n=t[31].x),i(e,"y1",l=t[31].y1),i(e,"x2",o=t[31].x),i(e,"y2",f=t[31].y2),i(e,"stroke",s=t[31].isOld?"#ff6b6b":"#000"),i(e,"stroke-width","2"),i(e,"marker-end",u=t[31].isOld?"url(#arrow-old)":"url(#arrow)")},m(h,a){x(h,e,a)},p(h,a){a[0]&4&&n!==(n=h[31].x)&&i(e,"x1",n),a[0]&4&&l!==(l=h[31].y1)&&i(e,"y1",l),a[0]&4&&o!==(o=h[31].x)&&i(e,"x2",o),a[0]&4&&f!==(f=h[31].y2)&&i(e,"y2",f),a[0]&4&&s!==(s=h[31].isOld?"#ff6b6b":"#000")&&i(e,"stroke",s),a[0]&4&&u!==(u=h[31].isOld?"url(#arrow-old)":"url(#arrow)")&&i(e,"marker-end",u)},d(h){h&&D(e)}}}function He(t){let e,n=t[31].x>t[4].x&&t[31].x<t[4].x+t[4].w&&xe(t);return{c(){n&&n.c(),e=le()},m(l,o){n&&n.m(l,o),x(l,e,o)},p(l,o){l[31].x>l[4].x&&l[31].x<l[4].x+l[4].w?n?n.p(l,o):(n=xe(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(l){l&&D(e),n&&n.d(l)}}}function Fe(t){let e,n,l;return{c(){e=ne("div"),i(e,"class","splitter svelte-x4wxi1")},m(o,f){x(o,e,f),n||(l=fe(e,"mousedown",t[11]),n=!0)},p:de,d(o){o&&D(e),n=!1,l()}}}function Ke(t){let e,n=K(Object.entries(t[0])),l=[];for(let o=0;o<n.length;o+=1)l[o]=Ue(Le(t,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=le()},m(o,f){for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(o,f);x(o,e,f)},p(o,f){if(f[0]&1){n=K(Object.entries(o[0]));let s;for(s=0;s<n.length;s+=1){const u=Le(o,n,s);l[s]?l[s].p(u,f):(l[s]=Ue(u),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}},d(o){o&&D(e),he(l,o)}}}function Ue(t){let e,n,l=t[27]+"",o,f,s=t[28]+"",u;return{c(){e=ne("div"),n=ne("span"),o=ee(l),f=ne("b"),u=ee(s),i(e,"class","row svelte-x4wxi1")},m(h,a){x(h,e,a),L(e,n),L(n,o),L(e,f),L(f,u)},p(h,a){a[0]&1&&l!==(l=h[27]+"")&&ie(o,l),a[0]&1&&s!==(s=h[28]+"")&&ie(u,s)},d(h){h&&D(e)}}}function vt(t){let e,n,l,o=t[6]?"→":"← hmap",f,s,u,h,a,m,c,y,r,O,C,W=[],P=new Map,N,U,G,J,d,A,E,R,Z,v=K(t[3]),p=[];for(let _=0;_<v.length;_+=1)p[_]=ze(Ye(t,v,_));let B=K(t[1]);const j=_=>_[34].id;for(let _=0;_<B.length;_+=1){let w=We(t,B,_),g=j(w);P.set(g,W[_]=De(g,w))}let S=K(t[2]),k=[];for(let _=0;_<S.length;_+=1)k[_]=He(Be(t,S,_));let Y=t[6]&&Fe(t),X=t[0]&&Ke(t);return{c(){e=ne("div"),n=ne("div"),l=ne("button"),f=ee(o),s=me(),u=I("svg"),h=I("defs"),a=I("marker"),m=I("path"),c=I("marker"),y=I("path"),r=I("filter"),O=I("feDropShadow");for(let _=0;_<p.length;_+=1)p[_].c();C=le();for(let _=0;_<W.length;_+=1)W[_].c();N=le();for(let _=0;_<k.length;_+=1)k[_].c();G=me(),Y&&Y.c(),J=me(),d=ne("div"),A=ne("h3"),A.textContent="hmap",E=me(),X&&X.c(),i(l,"class","toggle-btn svelte-x4wxi1"),i(m,"d","M0,0 L6,3 L0,6 Z"),i(m,"fill","#000"),i(a,"id","arrow"),i(a,"markerWidth","6"),i(a,"markerHeight","6"),i(a,"refX","3"),i(a,"refY","3"),i(a,"orient","auto"),i(y,"d","M0,0 L6,3 L0,6 Z"),i(y,"fill","#ff6b6b"),i(c,"id","arrow-old"),i(c,"markerWidth","6"),i(c,"markerHeight","6"),i(c,"refX","3"),i(c,"refY","3"),i(c,"orient","auto"),i(O,"dx","4"),i(O,"dy","4"),i(O,"stdDeviation","1"),i(O,"flood-color","#51cf66"),i(O,"flood-opacity","0.5"),i(r,"id","bucket-shadow"),i(r,"x","-30%"),i(r,"y","-30%"),i(r,"width","140%"),i(r,"height","140%"),i(u,"viewBox",U=t[4].x+" "+t[4].y+" "+t[4].w+" "+t[4].h),i(u,"width","100%"),i(u,"height","100%"),i(u,"preserveAspectRatio","xMinYMin meet"),i(u,"class","svelte-x4wxi1"),i(n,"id","svg-container"),i(n,"class","svelte-x4wxi1"),i(d,"class","side svelte-x4wxi1"),we(d,"width",t[5]+"px"),we(d,"display",t[6]?"block":"none"),i(e,"class","root svelte-x4wxi1")},m(_,w){x(_,e,w),L(e,n),L(n,l),L(l,f),L(n,s),L(n,u),L(u,h),L(h,a),L(a,m),L(h,c),L(c,y),L(h,r),L(r,O);for(let g=0;g<p.length;g+=1)p[g]&&p[g].m(u,null);L(u,C);for(let g=0;g<W.length;g+=1)W[g]&&W[g].m(u,null);L(u,N);for(let g=0;g<k.length;g+=1)k[g]&&k[g].m(u,null);L(e,G),Y&&Y.m(e,null),L(e,J),L(e,d),L(d,A),L(d,E),X&&X.m(d,null),R||(Z=[fe(l,"click",t[12]),fe(n,"wheel",t[7],{passive:!1}),fe(n,"mousedown",t[8]),fe(n,"mousemove",t[10]),fe(n,"mouseup",t[9]),fe(n,"mouseleave",t[9])],R=!0)},p(_,w){if(w[0]&64&&o!==(o=_[6]?"→":"← hmap")&&ie(f,o),w[0]&8){v=K(_[3]);let g;for(g=0;g<v.length;g+=1){const z=Ye(_,v,g);p[g]?p[g].p(z,w):(p[g]=ze(z),p[g].c(),p[g].m(u,C))}for(;g<p.length;g+=1)p[g].d(1);p.length=v.length}if(w[0]&18&&(B=K(_[1]),W=dt(W,w,j,1,_,B,P,u,ct,De,N,We)),w[0]&20){S=K(_[2]);let g;for(g=0;g<S.length;g+=1){const z=Be(_,S,g);k[g]?k[g].p(z,w):(k[g]=He(z),k[g].c(),k[g].m(u,null))}for(;g<k.length;g+=1)k[g].d(1);k.length=S.length}w[0]&16&&U!==(U=_[4].x+" "+_[4].y+" "+_[4].w+" "+_[4].h)&&i(u,"viewBox",U),_[6]?Y?Y.p(_,w):(Y=Fe(_),Y.c(),Y.m(e,J)):Y&&(Y.d(1),Y=null),_[0]?X?X.p(_,w):(X=Ke(_),X.c(),X.m(d,null)):X&&(X.d(1),X=null),w[0]&32&&we(d,"width",_[5]+"px"),w[0]&64&&we(d,"display",_[6]?"block":"none")},i:de,o:de,d(_){_&&D(e),he(p,_);for(let w=0;w<W.length;w+=1)W[w].d();he(k,_),Y&&Y.d(),X&&X.d(),R=!1,_e(Z)}}}const H=24,M=22,ue=80,$=40,Ve=4,Ze=12,q=12,qe=1.5,te=27;function kt(t,e,n){let l=null,o=!1,f=[],s=[],u=[],h=[],a=null,m=[],c=[],y=[],r={x:0,y:0,w:1200,h:900},O=280,C=280,W=!0,P=!1,N=!1;async function U(){try{const[p,B,j]=await Promise.all([fetch("/vizual").catch(()=>null),fetch("/vizual_old").catch(()=>null),fetch("/hmap").catch(()=>null)]);if(p!=null&&p.ok&&(f=await p.json(),Array.isArray(f)||(f=[])),B!=null&&B.ok&&(s=await B.json(),Array.isArray(s)||(s=[])),j!=null&&j.ok&&n(0,a=await j.json()),u=[],Array.isArray(f)){let S=[];for(const k of f)k&&k.type==="main"?(S.length&&u.push(S),S=[k]):k&&S.push(k);S.length&&u.push(S)}if(h=[],Array.isArray(s)){let S=[];for(const k of s)k&&k.type==="main"?(S.length&&h.push(S),S=[k]):k&&S.push(k);S.length&&h.push(S)}if(J(),!o){const S=document.getElementById("svg-container");if(S){const k=S.getBoundingClientRect(),Y=k.height/k.width;n(4,r.w=1200,r),n(4,r.h=1200*Y,r),n(4,r),o=!0}}}catch(p){console.error("Ошибка загрузки данных:",p)}}function G(){l&&l.close();const p=location.protocol==="https:"?"wss":"ws";l=new WebSocket(`${p}://${location.host}/ws`),l.onopen=()=>{console.log("[ws] connected")},l.onmessage=()=>{U()},l.onclose=()=>{console.log("[ws] disconnected, retrying..."),setTimeout(G,1e3)},l.onerror=()=>{l.close()}}function J(){n(1,m=[]),n(2,c=[]),n(3,y=[]);const p=h&&h.length>0,B=u&&u.length>0,j=p&&B;p&&h.forEach(w=>{w&&w.length>0}),B&&u.forEach(w=>{w&&w.length>0});const S=[];for(let w=0;w<Math.max(p?h.length:0,B?u.length:0);w++){let g=260;if(p&&w<h.length&&h[w]&&h[w].length>0){const z=h[w],T=Math.max(...z.map(b=>b.tophash&&Array.isArray(b.tophash)?b.tophash.length:0))*te,F=z.map(b=>{const oe=b.keys&&Array.isArray(b.keys)?b.keys:[],se=b.values&&Array.isArray(b.values)?b.values:[];return Math.max(...oe.map(Q=>Q?Q.toString().length:0),...se.map(Q=>Q?Q.toString().length:0),b.overflow?b.overflow.toString().length:0,0)*8+q*2});g=Math.max(g,...F,T)}if(B&&w<u.length&&u[w]&&u[w].length>0){const z=u[w],T=Math.max(...z.map(b=>b.tophash&&Array.isArray(b.tophash)?b.tophash.length:0))*te,F=z.map(b=>{const oe=b.keys&&Array.isArray(b.keys)?b.keys:[],se=b.values&&Array.isArray(b.values)?b.values:[];return Math.max(...oe.map(Q=>Q?Q.toString().length:0),...se.map(Q=>Q?Q.toString().length:0),b.overflow?b.overflow.toString().length:0,0)*8+q*2});g=Math.max(g,...F,T)}S.push(g)}let k=ue,Y=0,X=$+(j?30:0),_=$;if(p){for(let w=0;w<h.length;w++){const g=h[w];if(!g||g.length===0)continue;const z=S[w]||260;let T=X;for(let F=0;F<g.length;F++){const b=g[F];if(!b)continue;const oe=b.keys&&Array.isArray(b.keys)?b.keys:[],se=b.values&&Array.isArray(b.values)?b.values:[],V=H+oe.length*M+se.length*M+M+q*2;m.push({id:`old-${b.id}`,x:k,y:T,width:z,height:V,bucket:b,padding:q,isOld:!0}),F<g.length-1&&c.push({x:k+z/2,y1:T+V,y2:T+V+$-Ve,isOld:!0}),T+=V+$,T>Y&&(Y=T)}k+=z+ue}j&&y.push({x:ue,y:$+20,text:"OLD",isOld:!0}),_=Y+$*2}if(B){k=ue;for(let w=0;w<u.length;w++){const g=u[w];if(!g||g.length===0)continue;const z=S[w]||260;let T=_;for(let F=0;F<g.length;F++){const b=g[F];if(!b)continue;const oe=b.keys&&Array.isArray(b.keys)?b.keys:[],se=b.values&&Array.isArray(b.values)?b.values:[],V=H+oe.length*M+se.length*M+M+q*2;m.push({id:b.id,x:k,y:T,width:z,height:V,bucket:b,padding:q,isOld:!1}),F<g.length-1&&c.push({x:k+z/2,y1:T+V,y2:T+V+$-Ve,isOld:!1}),T+=V+$}k+=z+ue}j&&y.push({x:ue,y:_-$+20,text:"NEW",isOld:!1})}}function d(p){p.preventDefault();const B=p.currentTarget.getBoundingClientRect();if(p.ctrlKey||p.metaKey){const j=p.clientX-B.left,S=p.clientY-B.top,k=r.x+j*r.w/B.width,Y=r.y+S*r.h/B.height,X=Math.pow(1.001,p.deltaY*5),_=r.w*X,w=r.h*X;if(_<100||_>4e4)return;n(4,r.x=k-j/B.width*_,r),n(4,r.y=Y-S/B.height*w,r),n(4,r.w=_,r),n(4,r.h=w,r)}else n(4,r.x+=p.deltaX*r.w/B.width,r),n(4,r.y+=p.deltaY*r.h/B.height,r);n(4,r)}function A(p){p.button===0&&(N=!0)}function E(){N=!1}function R(p){if(N){const B=document.getElementById("svg-container").getBoundingClientRect();n(4,r.x-=p.movementX*r.w/B.width,r),n(4,r.y-=p.movementY*r.h/B.height,r),n(4,r)}}function Z(p){P=!0;const B=p.clientX,j=O,k=document.getElementById("svg-container").getBoundingClientRect(),Y=r.w/k.width;k.height/k.width;const X=w=>{if(!P)return;const g=B-w.clientX,z=Math.max(100,Math.min(800,j+g)),T=z-O;n(5,O=z),n(4,r.w-=T*Y,r);const F=k.width-(z-j);n(4,r.h=r.w*(k.height/F),r),n(4,r)},_=()=>{P=!1,window.removeEventListener("mousemove",X),window.removeEventListener("mouseup",_)};window.addEventListener("mousemove",X),window.addEventListener("mouseup",_)}function v(){const p=document.getElementById("svg-container"),B=p.getBoundingClientRect(),j=r.w/B.width;W?(C=O,n(4,r.w+=O*j,r),n(5,O=0),n(6,W=!1)):(n(5,O=C),n(4,r.w-=O*j,r),n(6,W=!0)),setTimeout(()=>{const S=p.getBoundingClientRect();n(4,r.h=r.w*(S.height/S.width),r),n(4,r)},0)}return st(()=>{U(),G()}),[a,m,c,y,r,O,W,d,A,E,R,Z,v]}class bt extends wt{constructor(e){super(),mt(this,e,kt,vt,nt,{},null,[-1,-1])}}new bt({target:document.getElementById("app")});
